<link rel="import" href="../lib/polymer/polymer.html">
<link rel='import' href='roster-group.html'>

<polymer-element name='uproxy-roster' attributes='contacts'>

  <template>
    <style>
    :host {
      position: absolute;
      display: inline-block;
      box-sizing: border-box;
      height: 550px;
      width: 100%;
      background-color: white;
      -webkit-transition: all 0.23s !important;
      -moz-transition: all 0.23s !important;
      transition: all 0.23s !important;
      top: 50px;
      overflow-y: hidden;
      overflow-y: scroll;
      right: 0px;
      z-index: 100;
    }
    :host(.hidden) {
      right: -100%;
    }
    #search {
      display: block;
      box-sizing: border-box;
      width: 100%;
      padding: 12px 16px;
      font-size: 14px;
      line-height: 20px;
      color: #888;
      outline: none;
      border: none;
      border-bottom: 1px solid #ddd;
      -webkit-transition: all 0.23s !important;
      -moz-transition: all 0.23s !important;
      transition: all 0.23s !important;
    }
    #search:hover {
      border-color: #aaa;
    }
    #sharingStatusBox {
      padding: 20px;
    }
    ::-webkit-input-placeholder {
      color: #ccc;
      font-weight: 100;
    }
    </style>

    <input type='text' id='search' placeholder='Search' value='{{ searchQuery }}'></input>

    <div id="sharingStatusBox">
      <div id="sharingStatus" hidden?='{{ !model.globalSettings.sharing }}'>
        Available for sharing.<br>
        <button on-click='{{ toggleSharing }}'>Stop Sharing</button>
      </div>
      <div id="notSharingStatus" hidden?='{{ model.globalSettings.sharing }}'>
        Unavailable for sharing.<br>
        <button on-click='{{ toggleSharing }}'>Start Sharing</button>
      </div>
    </div>

    <!-- trusted uProxy contacts -->
    <uproxy-roster-group
        title='Trusted uProxy Friends'
        onlineContacts='{{ onlineTrustedUproxyContacts }}'
        offlineContacts='{{ offlineTrustedUproxyContacts }}'
        searchQuery='{{ searchQuery }}'></uproxy-roster-group>

    <!-- Hide HR between Trusted and Untrusted if either group is completely empty -->
    <hr color="#eee"
        hidden?='{{ (onlineTrustedUproxyContacts.length == 0 && offlineTrustedUproxyContacts.length == 0) || (onlineUntrustedUproxyContacts.length == 0 && offlineUntrustedUproxyContacts.length == 0) }}'></hr>

    <!-- untrusted uProxy contacts -->
    <uproxy-roster-group
        title='All uProxy Contacts'
        onlineContacts='{{ onlineUntrustedUproxyContacts }}'
        offlineContacts='{{ offlineUntrustedUproxyContacts }}'
        searchQuery='{{ searchQuery }}'></uproxy-roster-group>

    <!-- hide hr if there are no non-uproxy contacts, or if there are only non-uProxy contacts -->
    <hr color="#eee"
        hidden?='{{ (onlineNonUproxyContacts.length == 0 && offlineNonUproxyContacts.length == 0) || ((onlineUntrustedUproxyContacts.length == 0 && offlineUntrustedUproxyContacts.length == 0) && (onlineTrustedUproxyContacts.length == 0 && offlineTrustedUproxyContacts.length == 0)) }}'></hr>

    <!-- non uProxy contacts -->
    <uproxy-roster-group
        title='Non uProxy Contacts'
        onlineContacts='{{ onlineNonUproxyContacts }}'
        offlineContacts='{{ offlineNonUproxyContacts }}'
        searchQuery='{{ searchQuery }}'></uproxy-roster-group>

  </template>

  <script src='roster.js'></script>

</polymer-element>
